31-Dec-23 19:09:34 - Exception occurred during loading
Traceback (most recent call last):
  File "C:\Python\Lib\site-packages\sqlalchemy\engine\base.py", line 2108, in _exec_insertmany_context
    dialect.do_execute(
  File "C:\Python\Lib\site-packages\sqlalchemy\engine\default.py", line 921, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "customer_data_customer_id_key"
DETAIL:  Key (customer_id)=(1) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raazx\OneDrive\Desktop\hamon\hamon-assignment\etl.py", line 164, in <module>
    df.to_sql(i, engine, index= False, if_exists = 'append')
  File "C:\Python\Lib\site-packages\pandas\core\generic.py", line 2878, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "C:\Python\Lib\site-packages\pandas\io\sql.py", line 767, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "C:\Python\Lib\site-packages\pandas\io\sql.py", line 1918, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\Lib\site-packages\pandas\io\sql.py", line 1468, in insert_records
    raise err
  File "C:\Python\Lib\site-packages\pandas\io\sql.py", line 1459, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\Lib\site-packages\pandas\io\sql.py", line 1021, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\Lib\site-packages\pandas\io\sql.py", line 927, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\Lib\site-packages\sqlalchemy\engine\base.py", line 1412, in execute
    return meth(
           ^^^^^
  File "C:\Python\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\Lib\site-packages\sqlalchemy\engine\base.py", line 1635, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\Lib\site-packages\sqlalchemy\engine\base.py", line 1839, in _execute_context
    return self._exec_insertmany_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python\Lib\site-packages\sqlalchemy\engine\base.py", line 2116, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "C:\Python\Lib\site-packages\sqlalchemy\engine\base.py", line 2339, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Python\Lib\site-packages\sqlalchemy\engine\base.py", line 2108, in _exec_insertmany_context
    dialect.do_execute(
  File "C:\Python\Lib\site-packages\sqlalchemy\engine\default.py", line 921, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "customer_data_customer_id_key"
DETAIL:  Key (customer_id)=(1) already exists.

[SQL: INSERT INTO customer_data (customer_id, first_name, last_name, email, phone) VALUES (%(customer_id__0)s, %(first_name__0)s, %(last_name__0)s, %(email__0)s, %(phone__0)s), (%(customer_id__1)s, %(first_name__1)s, %(last_name__1)s, %(email__1)s, %(phone__1)s), (%(customer_id__2)s, %(first_name__2)s, %(last_name__2)s, %(email__2)s, %(phone__2)s), (%(customer_id__3)s, %(first_name__3)s, %(last_name__3)s, %(email__3)s, %(phone__3)s)]
[parameters: {'phone__0': 1234567890, 'customer_id__0': 1, 'email__0': 'rahul@gmail.com', 'last_name__0': 'Rocco', 'first_name__0': 'Rahul', 'phone__1': 9876543210, 'customer_id__1': 2, 'email__1': 'rocco@gmail.com', 'last_name__1': 'Ray', 'first_name__1': 'Frosty', 'phone__2': 9632587410, 'customer_id__2': 3, 'email__2': 'kailenny@gmail.com', 'last_name__2': 'Lenny', 'first_name__2': 'Kai', 'phone__3': 3636363636, 'customer_id__3': 4, 'email__3': 'kate@gmail.com', 'last_name__3': 'Austen', 'first_name__3': 'Kate'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
31-Dec-23 19:09:34 - xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
